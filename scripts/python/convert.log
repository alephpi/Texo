[2025/09/24 15:56:02] ppocr WARNING: Skipping import of the encryption module.
---load paddle model---
[2025/09/24 15:56:16] ppocr INFO: load pretrain successful from ./models/rec_ppformulanet_s_train/best_accuracy

---summarizing paddle model---
------------------------------------------------------------------------------------------------------------------------------------------------------------------
          Layer (type)                Input Shape                                            Output Shape                                            Param #    
==================================================================================================================================================================
            Conv2D-1               [[1, 3, 384, 384]]                                      [1, 32, 192, 192]                                           864      
          BatchNorm2D-1           [[1, 32, 192, 192]]                                      [1, 32, 192, 192]                                           128      
             ReLU-1               [[1, 32, 192, 192]]                                      [1, 32, 192, 192]                                            0       
           ConvBNAct-1             [[1, 3, 384, 384]]                                      [1, 32, 192, 192]                                            0       
            Conv2D-2              [[1, 32, 192, 192]]                                      [1, 16, 192, 192]                                          2,048     
          BatchNorm2D-2           [[1, 16, 192, 192]]                                      [1, 16, 192, 192]                                           64       
             ReLU-2               [[1, 16, 192, 192]]                                      [1, 16, 192, 192]                                            0       
           ConvBNAct-2            [[1, 32, 192, 192]]                                      [1, 16, 192, 192]                                            0       
            Conv2D-3              [[1, 16, 192, 192]]                                      [1, 32, 192, 192]                                          2,048     
          BatchNorm2D-3           [[1, 32, 192, 192]]                                      [1, 32, 192, 192]                                           128      
             ReLU-3               [[1, 32, 192, 192]]                                      [1, 32, 192, 192]                                            0       
           ConvBNAct-3            [[1, 16, 192, 192]]                                      [1, 32, 192, 192]                                            0       
           MaxPool2D-1            [[1, 32, 192, 192]]                                      [1, 32, 192, 192]                                            0       
            Conv2D-4              [[1, 64, 192, 192]]                                       [1, 32, 96, 96]                                          18,432     
          BatchNorm2D-4            [[1, 32, 96, 96]]                                        [1, 32, 96, 96]                                            128      
             ReLU-4                [[1, 32, 96, 96]]                                        [1, 32, 96, 96]                                             0       
           ConvBNAct-4            [[1, 64, 192, 192]]                                       [1, 32, 96, 96]                                             0       
            Conv2D-5               [[1, 32, 96, 96]]                                        [1, 48, 96, 96]                                           1,536     
          BatchNorm2D-5            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-5                [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
           ConvBNAct-5             [[1, 32, 96, 96]]                                        [1, 48, 96, 96]                                             0       
           StemBlock-1             [[1, 3, 384, 384]]                                       [1, 48, 96, 96]                                             0       
            Conv2D-6               [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                          20,736     
          BatchNorm2D-6            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-6                [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
           ConvBNAct-6             [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
            Conv2D-7               [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                          20,736     
          BatchNorm2D-7            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-7                [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
           ConvBNAct-7             [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
            Conv2D-8               [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                          20,736     
          BatchNorm2D-8            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-8                [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
           ConvBNAct-8             [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
            Conv2D-9               [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                          20,736     
          BatchNorm2D-9            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-9                [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
           ConvBNAct-9             [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
            Conv2D-10              [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                          20,736     
         BatchNorm2D-10            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-10               [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
          ConvBNAct-10             [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
            Conv2D-11              [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                          20,736     
         BatchNorm2D-11            [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                            192      
             ReLU-11               [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
          ConvBNAct-11             [[1, 48, 96, 96]]                                        [1, 48, 96, 96]                                             0       
            Conv2D-12              [[1, 336, 96, 96]]                                       [1, 64, 96, 96]                                          21,504     
         BatchNorm2D-12            [[1, 64, 96, 96]]                                        [1, 64, 96, 96]                                            256      
             ReLU-12               [[1, 64, 96, 96]]                                        [1, 64, 96, 96]                                             0       
          ConvBNAct-12             [[1, 336, 96, 96]]                                       [1, 64, 96, 96]                                             0       
            Conv2D-13              [[1, 64, 96, 96]]                                       [1, 128, 96, 96]                                           8,192     
         BatchNorm2D-13            [[1, 128, 96, 96]]                                      [1, 128, 96, 96]                                            512      
             ReLU-13               [[1, 128, 96, 96]]                                      [1, 128, 96, 96]                                             0       
          ConvBNAct-13             [[1, 64, 96, 96]]                                       [1, 128, 96, 96]                                             0       
          HGV2_Block-1             [[1, 48, 96, 96]]                                       [1, 128, 96, 96]                                             0       
          HGV2_Stage-1             [[1, 48, 96, 96]]                                       [1, 128, 96, 96]                                             0       
            Conv2D-14              [[1, 128, 96, 96]]                                      [1, 128, 48, 48]                                           1,152     
         BatchNorm2D-14            [[1, 128, 48, 48]]                                      [1, 128, 48, 48]                                            512      
          ConvBNAct-14             [[1, 128, 96, 96]]                                      [1, 128, 48, 48]                                             0       
            Conv2D-15              [[1, 128, 48, 48]]                                       [1, 96, 48, 48]                                          110,592    
         BatchNorm2D-15            [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                            384      
             ReLU-14               [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
          ConvBNAct-15             [[1, 128, 48, 48]]                                       [1, 96, 48, 48]                                             0       
            Conv2D-16              [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                          82,944     
         BatchNorm2D-16            [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                            384      
             ReLU-15               [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
          ConvBNAct-16             [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
            Conv2D-17              [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                          82,944     
         BatchNorm2D-17            [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                            384      
             ReLU-16               [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
          ConvBNAct-17             [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
            Conv2D-18              [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                          82,944     
         BatchNorm2D-18            [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                            384      
             ReLU-17               [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
          ConvBNAct-18             [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
            Conv2D-19              [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                          82,944     
         BatchNorm2D-19            [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                            384      
             ReLU-18               [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
          ConvBNAct-19             [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
            Conv2D-20              [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                          82,944     
         BatchNorm2D-20            [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                            384      
             ReLU-19               [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
          ConvBNAct-20             [[1, 96, 48, 48]]                                        [1, 96, 48, 48]                                             0       
            Conv2D-21              [[1, 704, 48, 48]]                                      [1, 256, 48, 48]                                          180,224    
         BatchNorm2D-21            [[1, 256, 48, 48]]                                      [1, 256, 48, 48]                                           1,024     
             ReLU-20               [[1, 256, 48, 48]]                                      [1, 256, 48, 48]                                             0       
          ConvBNAct-21             [[1, 704, 48, 48]]                                      [1, 256, 48, 48]                                             0       
            Conv2D-22              [[1, 256, 48, 48]]                                      [1, 512, 48, 48]                                          131,072    
         BatchNorm2D-22            [[1, 512, 48, 48]]                                      [1, 512, 48, 48]                                           2,048     
             ReLU-21               [[1, 512, 48, 48]]                                      [1, 512, 48, 48]                                             0       
          ConvBNAct-22             [[1, 256, 48, 48]]                                      [1, 512, 48, 48]                                             0       
          HGV2_Block-2             [[1, 128, 48, 48]]                                      [1, 512, 48, 48]                                             0       
          HGV2_Stage-2             [[1, 128, 96, 96]]                                      [1, 512, 48, 48]                                             0       
            Conv2D-23              [[1, 512, 48, 48]]                                      [1, 512, 24, 24]                                           4,608     
         BatchNorm2D-23            [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                           2,048     
          ConvBNAct-23             [[1, 512, 48, 48]]                                      [1, 512, 24, 24]                                             0       
            Conv2D-24              [[1, 512, 24, 24]]                                      [1, 192, 24, 24]                                          98,304     
         BatchNorm2D-24            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-24             [[1, 512, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-25              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-25            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-22               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-25             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-1           [[1, 512, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-26              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-26            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-26             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-27              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-27            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-23               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-27             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-2           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-28              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-28            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-28             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-29              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-29            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-24               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-29             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-3           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-30              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-30            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-30             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-31              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-31            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-25               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-31             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-4           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-32              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-32            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-32             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-33              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-33            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-26               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-33             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-5           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-34              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-34            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-34             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-35              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-35            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-27               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-35             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-6           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-36             [[1, 1664, 24, 24]]                                      [1, 512, 24, 24]                                          851,968    
         BatchNorm2D-36            [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                           2,048     
             ReLU-28               [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                             0       
          ConvBNAct-36            [[1, 1664, 24, 24]]                                      [1, 512, 24, 24]                                             0       
            Conv2D-37              [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                         524,288    
         BatchNorm2D-37           [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                          4,096     
             ReLU-29              [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          ConvBNAct-37             [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          HGV2_Block-3             [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
            Conv2D-38             [[1, 1024, 24, 24]]                                      [1, 192, 24, 24]                                          196,608    
         BatchNorm2D-38            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-38            [[1, 1024, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-39              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-39            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-30               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-39             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-7          [[1, 1024, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-40              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-40            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-40             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-41              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-41            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-31               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-41             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-8           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-42              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-42            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-42             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-43              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-43            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-32               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-43             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-9           [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-44              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-44            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-44             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-45              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-45            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-33               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-45             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-10          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-46              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-46            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-46             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-47              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-47            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-34               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-47             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-11          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-48              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-48            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-48             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-49              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-49            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-35               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-49             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-12          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-50             [[1, 2176, 24, 24]]                                      [1, 512, 24, 24]                                         1,114,112   
         BatchNorm2D-50            [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                           2,048     
             ReLU-36               [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                             0       
          ConvBNAct-50            [[1, 2176, 24, 24]]                                      [1, 512, 24, 24]                                             0       
            Conv2D-51              [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                         524,288    
         BatchNorm2D-51           [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                          4,096     
             ReLU-37              [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          ConvBNAct-51             [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          HGV2_Block-4            [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
            Conv2D-52             [[1, 1024, 24, 24]]                                      [1, 192, 24, 24]                                          196,608    
         BatchNorm2D-52            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-52            [[1, 1024, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-53              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-53            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-38               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-53             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-13         [[1, 1024, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-54              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-54            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-54             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-55              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-55            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-39               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-55             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-14          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-56              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-56            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-56             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-57              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-57            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-40               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-57             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-15          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-58              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-58            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-58             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-59              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-59            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-41               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-59             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-16          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-60              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-60            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-60             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-61              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-61            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-42               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-61             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-17          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-62              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                          36,864     
         BatchNorm2D-62            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
          ConvBNAct-62             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-63              [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                           4,800     
         BatchNorm2D-63            [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                            768      
             ReLU-43               [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
          ConvBNAct-63             [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
        LightConvBNAct-18          [[1, 192, 24, 24]]                                      [1, 192, 24, 24]                                             0       
            Conv2D-64             [[1, 2176, 24, 24]]                                      [1, 512, 24, 24]                                         1,114,112   
         BatchNorm2D-64            [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                           2,048     
             ReLU-44               [[1, 512, 24, 24]]                                      [1, 512, 24, 24]                                             0       
          ConvBNAct-64            [[1, 2176, 24, 24]]                                      [1, 512, 24, 24]                                             0       
            Conv2D-65              [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                         524,288    
         BatchNorm2D-65           [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                          4,096     
             ReLU-45              [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          ConvBNAct-65             [[1, 512, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          HGV2_Block-5            [[1, 1024, 24, 24]]                                      [1, 1024, 24, 24]                                            0       
          HGV2_Stage-3             [[1, 512, 48, 48]]                                      [1, 1024, 24, 24]                                            0       
            Conv2D-66             [[1, 1024, 24, 24]]                                      [1, 1024, 12, 12]                                          9,216     
         BatchNorm2D-66           [[1, 1024, 12, 12]]                                      [1, 1024, 12, 12]                                          4,096     
          ConvBNAct-66            [[1, 1024, 24, 24]]                                      [1, 1024, 12, 12]                                            0       
            Conv2D-67             [[1, 1024, 12, 12]]                                      [1, 384, 12, 12]                                          393,216    
         BatchNorm2D-67            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
          ConvBNAct-67            [[1, 1024, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-68              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           9,600     
         BatchNorm2D-68            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
             ReLU-46               [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
          ConvBNAct-68             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
        LightConvBNAct-19         [[1, 1024, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-69              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                          147,456    
         BatchNorm2D-69            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
          ConvBNAct-69             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-70              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           9,600     
         BatchNorm2D-70            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
             ReLU-47               [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
          ConvBNAct-70             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
        LightConvBNAct-20          [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-71              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                          147,456    
         BatchNorm2D-71            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
          ConvBNAct-71             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-72              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           9,600     
         BatchNorm2D-72            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
             ReLU-48               [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
          ConvBNAct-72             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
        LightConvBNAct-21          [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-73              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                          147,456    
         BatchNorm2D-73            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
          ConvBNAct-73             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-74              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           9,600     
         BatchNorm2D-74            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
             ReLU-49               [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
          ConvBNAct-74             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
        LightConvBNAct-22          [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-75              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                          147,456    
         BatchNorm2D-75            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
          ConvBNAct-75             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-76              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           9,600     
         BatchNorm2D-76            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
             ReLU-50               [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
          ConvBNAct-76             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
        LightConvBNAct-23          [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-77              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                          147,456    
         BatchNorm2D-77            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
          ConvBNAct-77             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-78              [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           9,600     
         BatchNorm2D-78            [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                           1,536     
             ReLU-51               [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
          ConvBNAct-78             [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
        LightConvBNAct-24          [[1, 384, 12, 12]]                                      [1, 384, 12, 12]                                             0       
            Conv2D-79             [[1, 3328, 12, 12]]                                      [1, 1024, 12, 12]                                        3,407,872   
         BatchNorm2D-79           [[1, 1024, 12, 12]]                                      [1, 1024, 12, 12]                                          4,096     
             ReLU-52              [[1, 1024, 12, 12]]                                      [1, 1024, 12, 12]                                            0       
          ConvBNAct-79            [[1, 3328, 12, 12]]                                      [1, 1024, 12, 12]                                            0       
            Conv2D-80             [[1, 1024, 12, 12]]                                      [1, 2048, 12, 12]                                        2,097,152   
         BatchNorm2D-80           [[1, 2048, 12, 12]]                                      [1, 2048, 12, 12]                                          8,192     
             ReLU-53              [[1, 2048, 12, 12]]                                      [1, 2048, 12, 12]                                            0       
          ConvBNAct-80            [[1, 1024, 12, 12]]                                      [1, 2048, 12, 12]                                            0       
          HGV2_Block-6            [[1, 1024, 12, 12]]                                      [1, 2048, 12, 12]                                            0       
          HGV2_Stage-4            [[1, 1024, 24, 24]]                                      [1, 2048, 12, 12]                                            0       
           PPHGNetV2-1             [[1, 3, 384, 384]]                                      [1, 2048, 12, 12]                                            0       
     PPHGNetV2_B4_Formula-1        [[1, 3, 384, 384]]                                             []                                                    0       
           Linear-213               [[1, 144, 2048]]                                         [1, 144, 384]                                           786,816    
           Embedding-4                 [[1, 100]]                                            [1, 100, 384]                                         19,200,000   
MBartLearnedPositionalEmbedding-4   [[1, 100], None]                                         [1, 100, 384]                                           395,136    
          myLayerNorm-4             [[1, 100, 384]]                                          [1, 100, 384]                                             768      
          LayerNorm-62              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
           Linear-195               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-193               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-194               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-196               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
        MBartAttention-37                  []                          [[1, 100, 384], [], [[1, 16, 100, 24], [1, 16, 100, 24]]]                        0       
          LayerNorm-63              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
           Linear-199               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-197               [[1, 144, 384]]                                          [1, 144, 384]                                           147,840    
           Linear-198               [[1, 144, 384]]                                          [1, 144, 384]                                           147,840    
           Linear-200               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
        MBartAttention-38                  []                          [[1, 100, 384], [], [[1, 16, 144, 24], [1, 16, 144, 24]]]                        0       
          LayerNorm-64              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
           Linear-201               [[1, 100, 384]]                                         [1, 100, 1536]                                           591,360    
           Linear-202               [[1, 100, 1536]]                                         [1, 100, 384]                                           590,208    
      MBartDecoderLayer-19          [[1, 100, 384]]    [[1, 100, 384], [[1, 16, 100, 24], [1, 16, 100, 24], [1, 16, 144, 24], [1, 16, 144, 24]]]        0       
          LayerNorm-65              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
           Linear-205               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-203               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-204               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-206               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
        MBartAttention-39                  []                          [[1, 100, 384], [], [[1, 16, 100, 24], [1, 16, 100, 24]]]                        0       
          LayerNorm-66              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
           Linear-209               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
           Linear-207               [[1, 144, 384]]                                          [1, 144, 384]                                           147,840    
           Linear-208               [[1, 144, 384]]                                          [1, 144, 384]                                           147,840    
           Linear-210               [[1, 100, 384]]                                          [1, 100, 384]                                           147,840    
        MBartAttention-40                  []                          [[1, 100, 384], [], [[1, 16, 144, 24], [1, 16, 144, 24]]]                        0       
          LayerNorm-67              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
           Linear-211               [[1, 100, 384]]                                         [1, 100, 1536]                                           591,360    
           Linear-212               [[1, 100, 1536]]                                         [1, 100, 384]                                           590,208    
      MBartDecoderLayer-20          [[1, 100, 384]]    [[1, 100, 384], [[1, 16, 100, 24], [1, 16, 100, 24], [1, 16, 144, 24], [1, 16, 144, 24]]]        0       
          LayerNorm-68              [[1, 100, 384]]                                          [1, 100, 384]                                             768      
      CustomMBartDecoder-2                 []                                                     []                                                    0       
           Linear-192               [[1, 100, 384]]                                         [1, 100, 50000]                                        19,200,000   
    CustomMBartForCausalLM-2               []                                                     []                                                    0       
==================================================================================================================================================================
Total params: 57,915,744
Trainable params: 57,870,048
Non-trainable params: 45,696
------------------------------------------------------------------------------------------------------------------------------------------------------------------
Input size (MB): 1.69
Forward/backward pass size (MB): 725.36
Params size (MB): 220.93
Estimated Total Size (MB): 947.98
------------------------------------------------------------------------------------------------------------------------------------------------------------------

pp_total_params=57915744, pp_trainable_params=57870048
Paddle counts BN running stats as its non_trainable params while torch doesn't count them as params(but buffers)

---load torch model---

---summarizing torch model---
===================================================================================================================
Layer (type:depth-idx)                                            Output Shape              Param #
===================================================================================================================
FormulaNet                                                        [16, 144, 2048]           --
HGNetv2: 1-1                                                    [16, 144, 2048]           --
    StemBlock: 2-1                                             [16, 48, 96, 96]          --
        ConvBNAct: 3-1                                        [16, 32, 192, 192]        928
        ConvBNAct: 3-2                                        [16, 16, 192, 192]        2,080
        ConvBNAct: 3-3                                        [16, 32, 192, 192]        2,112
        MaxPool2d: 3-4                                        [16, 32, 192, 192]        --
        ConvBNAct: 3-5                                        [16, 32, 96, 96]          18,496
        ConvBNAct: 3-6                                        [16, 48, 96, 96]          1,632
    ModuleList: 2-2                                            --                        --
        HG_Stage: 3-7                                         [16, 128, 96, 96]         155,072
        HG_Stage: 3-8                                         [16, 512, 48, 48]         840,704
        HG_Stage: 3-9                                         [16, 1024, 24, 24]        5,812,608
        HG_Stage: 3-10                                        [16, 2048, 12, 12]        6,719,744
Linear: 1-2                                                     [16, 144, 384]            786,816
MBartForCausalLM: 1-3                                           [16, 16, 100, 24]         --
    MBartDecoderWrapper: 2-3                                   --                        --
        MBartDecoder: 3-11                                    [16, 16, 100, 24]         24,329,856
    Linear: 2-4                                                [16, 100, 50000]          19,200,000
===================================================================================================================
Total params: 57,870,048
Trainable params: 57,870,048
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 128.98
===================================================================================================================
Input size (MB): 28.32
Forward/backward pass size (MB): 5872.13
Params size (MB): 231.48
Estimated Total Size (MB): 6131.94
===================================================================================================================
pt_total_params=57870048, pt_trainable_params=57870048

---converting encoder---
max absolute difference in params: 0.0

---validating encoder---
output shape=(16, 144, 2048)
max absolute difference in output tensor: 4.57763671875e-05

---converting decoder---
max absolute difference in params: 0.0

---validating decoder---
output shape=(16, 100, 50000)
max absolute difference in output tensor: 1.621246337890625e-05
difference in label prediction: 0

---convert projection layer---
max absolute difference in params: 0.0

---validating whole model---
output shape=(16, 100, 50000)
max absolute difference in output tensor: 3.7670135498046875e-05
difference in label prediction: 0
formulanet saved to /home/mao/workspace/SynTeX/src/syntex/formula_net/formulanet.pt
